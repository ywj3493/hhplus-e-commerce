# Cart Domain - Use Cases

**문서 정보**
- **버전**: 2.0.0
- **최종 수정일**: 2025-11-03
- **상태**: Active
- **작성자**: Development Team
- **대상 독자**: Product Managers, Business Analysts, QA

---

**문서 네비게이션**
- ⬆️ 상위: [Dashboard 개요](../README.md)
- ⬅️ 이전: [Product 시퀀스 다이어그램](../product/sequence-diagrams.md)
- ➡️ 다음: [Cart 시퀀스 다이어그램](./sequence-diagrams.md)
- 🔗 기술 문서: [Cart 시퀀스 다이어그램](./sequence-diagrams.md)

---

## 목차
1. [개요](#1-개요)
2. [유스케이스 목록](#2-유스케이스-목록)
3. [UC-CART-01: 장바구니 아이템 추가](#3-uc-cart-01-장바구니-아이템-추가)
4. [UC-CART-02: 장바구니 조회](#4-uc-cart-02-장바구니-조회)
5. [UC-CART-03: 장바구니 아이템 수량 변경](#5-uc-cart-03-장바구니-아이템-수량-변경)
6. [UC-CART-04: 장바구니 아이템 삭제](#6-uc-cart-04-장바구니-아이템-삭제)
7. [UC-CART-05: 장바구니 전체 삭제](#7-uc-cart-05-장바구니-전체-삭제)

---

## 1. 개요

### 1.1 도메인 설명
Cart 도메인은 고객의 장바구니 관리를 담당합니다. 주문 전 상품을 임시로 보관하고, 수량 조정 및 삭제 기능을 제공합니다.

### 1.2 주요 책임
- 장바구니에 상품 추가
- 장바구니 아이템 조회
- 아이템 수량 변경
- 아이템 삭제 (개별/전체)
- 재고 검증

### 1.3 관련 문서
- [요구사항: FR-CART-01 ~ FR-CART-05](../requirements.md)
- [사용자 스토리: US-CART-01 ~ US-CART-06](../user-stories.md)
- [API 명세: Cart APIs](../api-specification.md)
- [데이터 모델: Cart Domain](../data-model.md)
- [기술 명세: Cart 시퀀스 다이어그램](./sequence-diagrams.md)

---

## 2. 유스케이스 목록

| ID | 유스케이스 명 | Actor | User Story | API Endpoint | 우선순위 |
|----|---------------|-------|------------|--------------|----------|
| UC-CART-01 | 장바구니 아이템 추가 | Customer | US-CART-01 | POST /carts/items | MUST |
| UC-CART-02 | 장바구니 조회 | Customer | US-CART-02 | GET /carts | MUST |
| UC-CART-03 | 장바구니 아이템 수량 변경 | Customer | US-CART-03 | PATCH /carts/items/:id | MUST |
| UC-CART-04 | 장바구니 아이템 삭제 | Customer | US-CART-04 | DELETE /carts/items/:id | MUST |
| UC-CART-05 | 장바구니 전체 삭제 | Customer | US-CART-05 | DELETE /carts | SHOULD |

---

## 3. UC-CART-01: 장바구니 아이템 추가

### 3.1 기본 정보

| 항목 | 내용 |
|------|------|
| **Use Case ID** | UC-CART-01 |
| **Use Case 명** | 장바구니 아이템 추가 |
| **Actor** | Customer |
| **Goal** | 고객이 원하는 상품을 장바구니에 담아 나중에 주문할 수 있도록 한다 |
| **관련 User Story** | US-CART-01 |
| **관련 요구사항** | FR-CART-01 |
| **API Endpoint** | POST /carts/items |
| **우선순위** | MUST |

### 3.2 유스케이스 설명
고객이 상품을 장바구니에 추가합니다. 재고를 검증하고, 동일 상품이 이미 있으면 수량을 증가시킵니다.

### 3.3 사전 조건 (Pre-conditions)
- 고객이 인증된 상태여야 함
- 추가하려는 상품이 시스템에 존재해야 함
- 선택한 상품 옵션이 유효해야 함

### 3.4 주요 흐름 (Main Flow)

1. **상품 선택**
   - 고객이 상품 상세 페이지에서 옵션(색상, 사이즈)을 선택한다
   - 고객이 구매 수량을 입력한다
   - 고객이 "장바구니 담기" 버튼을 클릭한다

2. **재고 확인**
   - 시스템은 선택한 옵션의 재고를 실시간으로 확인한다
   - 시스템은 요청한 수량이 재고 범위 내인지 검증한다

3. **장바구니 처리**
   - 고객의 장바구니가 없으면 시스템이 새로 생성한다
   - 동일한 상품+옵션이 이미 장바구니에 있는지 확인한다
   - **있는 경우**: 기존 아이템의 수량을 증가시킨다
   - **없는 경우**: 새로운 아이템으로 추가한다

4. **결과 표시**
   - 시스템은 "장바구니에 추가되었습니다" 메시지를 표시한다
   - 시스템은 장바구니 아이콘에 아이템 개수를 업데이트한다
   - 고객은 "장바구니 보기" 또는 "쇼핑 계속하기"를 선택할 수 있다

### 3.5 대체 흐름 (Alternative Flows)

**AF-1: 재고 부족**
- 시스템은 "재고가 부족합니다. 현재 X개만 구매 가능합니다" 메시지를 표시한다
- 고객은 수량을 조정하거나 취소할 수 있다

**AF-2: 존재하지 않는 상품**
- 시스템은 "상품을 찾을 수 없습니다" 에러 메시지를 표시한다
- 고객은 상품 목록 페이지로 돌아간다

**AF-3: 수량이 0 이하**
- 시스템은 "수량은 1 이상이어야 합니다" 에러 메시지를 표시한다
- 고객은 올바른 수량을 입력한다

### 3.6 사후 조건 (Post-conditions)
- 선택한 상품이 고객의 장바구니에 추가된다
- 고객은 장바구니 페이지에서 추가한 상품을 확인할 수 있다
- 고객은 언제든지 주문을 진행할 수 있다

### 3.7 비즈니스 규칙 (Business Rules)

| ID | 규칙 | 설명 |
|----|------|------|
| BR-CART-01 | 중복 아이템 처리 | 동일 상품+옵션이 있으면 수량만 증가 |
| BR-CART-02 | 재고 검증 | 추가 시 재고를 초과할 수 없음 |
| BR-CART-03 | 최소 수량 | 수량은 1 이상이어야 함 |
| BR-CART-04 | 사용자당 장바구니 | 한 사용자는 하나의 장바구니만 가짐 |

### 3.8 예외 케이스 (Exception Cases)

| 예외 상황 | 시스템 동작 |
|-----------|-------------|
| 존재하지 않는 상품 | 404 Not Found: "상품을 찾을 수 없습니다." |
| 재고 부족 | 409 Conflict: "재고가 부족합니다." |
| 잘못된 수량 (< 1) | 400 Bad Request: "수량은 1 이상이어야 합니다." |

### 3.9 관련 유스케이스
- [UC-PROD-02: 상품 상세 조회](../product/use-cases.md) - 상품 정보 확인
- [UC-PROD-04: 재고 조회](../product/use-cases.md) - 재고 확인
- [UC-CART-02: 장바구니 조회](#4-uc-cart-02-장바구니-조회) - 추가 후 확인

---

## 4. UC-CART-02: 장바구니 조회

### 4.1 기본 정보

| 항목 | 내용 |
|------|------|
| **Use Case ID** | UC-CART-02 |
| **Use Case 명** | 장바구니 조회 |
| **Actor** | Customer |
| **Goal** | 고객이 장바구니에 담긴 상품들을 확인하고 주문 전 검토한다 |
| **관련 User Story** | US-CART-02 |
| **관련 요구사항** | FR-CART-02 |
| **API Endpoint** | GET /carts |
| **우선순위** | MUST |

### 4.2 유스케이스 설명
현재 로그인한 고객의 장바구니 전체 내역을 조회합니다. 총 금액과 아이템 목록을 포함합니다.

### 4.3 사전 조건 (Pre-conditions)
- 고객이 인증된 상태여야 함

### 4.4 주요 흐름 (Main Flow)

1. **장바구니 접근**
   - 고객이 네비게이션 바의 장바구니 아이콘을 클릭한다
   - 시스템은 장바구니 페이지로 이동한다

2. **아이템 목록 표시**
   - 시스템은 장바구니에 담긴 모든 아이템을 표시한다:
     - 상품 이미지
     - 상품명
     - 선택한 옵션 (색상, 사이즈)
     - 개당 가격
     - 수량
     - 소계 (가격 × 수량)
   - 각 아이템마다 수량 조절 및 삭제 버튼을 제공한다

3. **총 금액 계산**
   - 시스템은 모든 아이템의 소계를 합산하여 총 금액을 표시한다
   - 총 금액 = Σ (각 아이템 가격 × 수량)

4. **주문 진행 옵션**
   - 시스템은 "주문하기" 버튼을 제공한다
   - 고객은 주문 프로세스를 진행하거나 쇼핑을 계속할 수 있다

### 4.5 대체 흐름 (Alternative Flows)

**AF-1: 빈 장바구니**
- 시스템은 "장바구니가 비어 있습니다" 메시지를 표시한다
- 시스템은 "쇼핑 계속하기" 버튼을 제공한다
- 고객은 상품 목록 페이지로 이동할 수 있다

### 4.6 사후 조건 (Post-conditions)
- 고객이 장바구니의 모든 내용을 확인한다
- 고객이 총 결제 금액을 파악한다
- 고객이 주문 진행 여부를 결정할 수 있다

### 4.7 비즈니스 규칙 (Business Rules)

| ID | 규칙 | 설명 |
|----|------|------|
| BR-CART-05 | 총 금액 계산 | 총 금액 = Σ (아이템 가격 × 수량) |
| BR-CART-06 | 빈 장바구니 처리 | 아이템이 없으면 빈 배열과 0원 표시 |

### 4.8 예외 케이스 (Exception Cases)

| 예외 상황 | 시스템 동작 |
|-----------|-------------|
| 인증 실패 | 401 Unauthorized: "인증이 필요합니다." |

---

## 5. UC-CART-03: 장바구니 아이템 수량 변경

### 5.1 기본 정보

| 항목 | 내용 |
|------|------|
| **Use Case ID** | UC-CART-03 |
| **Use Case 명** | 장바구니 아이템 수량 변경 |
| **Actor** | Customer |
| **Goal** | 고객이 장바구니에 담긴 상품의 수량을 조절하여 원하는 만큼 주문한다 |
| **관련 User Story** | US-CART-03 |
| **관련 요구사항** | FR-CART-03 |
| **API Endpoint** | PATCH /carts/items/:id |
| **우선순위** | MUST |

### 5.2 유스케이스 설명
장바구니에 담긴 특정 아이템의 수량을 변경합니다. 재고를 검증하고, 수량이 0 이하면 아이템을 삭제합니다.

### 5.3 사전 조건 (Pre-conditions)
- 고객이 인증된 상태여야 함
- 장바구니에 변경하려는 아이템이 존재해야 함

### 5.4 주요 흐름 (Main Flow)

1. **수량 조절**
   - 고객이 장바구니 페이지에서 특정 아이템의 수량을 변경한다
   - 수량 증가: "+" 버튼 클릭
   - 수량 감소: "-" 버튼 클릭
   - 또는 직접 숫자를 입력한다

2. **재고 확인 (수량 증가 시)**
   - 시스템은 증가된 수량이 재고 범위 내인지 확인한다
   - 재고가 충분하면 수량을 업데이트한다

3. **수량 업데이트**
   - 시스템은 해당 아이템의 수량을 변경한다
   - 시스템은 아이템 소계를 다시 계산한다
   - 시스템은 장바구니 총 금액을 다시 계산한다

4. **결과 표시**
   - 시스템은 변경된 수량과 금액을 즉시 반영하여 표시한다
   - 고객이 변경 사항을 확인할 수 있다

### 5.5 대체 흐름 (Alternative Flows)

**AF-1: 수량을 0 이하로 변경**
- 시스템은 해당 아이템을 장바구니에서 자동으로 삭제한다
- 시스템은 "아이템이 삭제되었습니다" 메시지를 표시한다

**AF-2: 재고 부족 (수량 증가 시)**
- 시스템은 "재고가 부족합니다. 최대 X개까지 구매 가능합니다" 메시지를 표시한다
- 시스템은 수량을 변경 전 상태로 유지한다
- 고객은 재고 범위 내에서 수량을 다시 설정할 수 있다

**AF-3: 존재하지 않는 아이템**
- 시스템은 "아이템을 찾을 수 없습니다" 에러 메시지를 표시한다
- 시스템은 장바구니를 새로고침하여 최신 상태를 표시한다

### 5.6 사후 조건 (Post-conditions)
- 아이템의 수량이 변경된다
- 장바구니 총 금액이 업데이트된다
- 고객이 변경된 내용을 확인할 수 있다

### 5.7 비즈니스 규칙 (Business Rules)

| ID | 규칙 | 설명 |
|----|------|------|
| BR-CART-07 | 수량 0 이하 처리 | 수량이 0 이하가 되면 아이템 자동 삭제 |
| BR-CART-08 | 재고 검증 (증가 시) | 수량 증가 시에만 재고 확인 |
| BR-CART-09 | 재고 검증 불필요 (감소 시) | 수량 감소 시에는 재고 확인 안 함 |

### 5.8 예외 케이스 (Exception Cases)

| 예외 상황 | 시스템 동작 |
|-----------|-------------|
| 장바구니를 찾을 수 없음 | 404 Not Found: "장바구니를 찾을 수 없습니다." |
| 아이템을 찾을 수 없음 | 404 Not Found: "아이템을 찾을 수 없습니다." |
| 재고 부족 | 409 Conflict: "재고가 부족합니다." |
| 다른 사용자의 장바구니 | 403 Forbidden: "권한이 없습니다." |

---

## 6. UC-CART-04: 장바구니 아이템 삭제

### 6.1 기본 정보

| 항목 | 내용 |
|------|------|
| **Use Case ID** | UC-CART-04 |
| **Use Case 명** | 장바구니 아이템 삭제 |
| **Actor** | Customer |
| **Goal** | 고객이 더 이상 구매하지 않을 상품을 장바구니에서 제거한다 |
| **관련 User Story** | US-CART-04 |
| **관련 요구사항** | FR-CART-04 |
| **API Endpoint** | DELETE /carts/items/:id |
| **우선순위** | MUST |

### 6.2 유스케이스 설명
장바구니에서 특정 아이템을 삭제합니다.

### 6.3 사전 조건 (Pre-conditions)
- 고객이 인증된 상태여야 함
- 장바구니에 삭제하려는 아이템이 존재해야 함

### 6.4 주요 흐름 (Main Flow)

1. **삭제 요청**
   - 고객이 장바구니 페이지에서 특정 아이템의 "삭제" 버튼을 클릭한다
   - 시스템은 확인 다이얼로그를 표시한다 (선택사항)

2. **아이템 삭제**
   - 고객이 삭제를 확인한다
   - 시스템은 해당 아이템을 장바구니에서 제거한다
   - 시스템은 장바구니 총 금액을 다시 계산한다

3. **결과 표시**
   - 시스템은 "아이템이 삭제되었습니다" 메시지를 표시한다
   - 시스템은 업데이트된 장바구니를 표시한다
   - 장바구니 아이콘의 아이템 개수가 업데이트된다

### 6.5 대체 흐름 (Alternative Flows)

**AF-1: 삭제 취소**
- 고객이 확인 다이얼로그에서 "취소"를 클릭한다
- 시스템은 아무 변경 없이 장바구니 페이지를 유지한다

**AF-2: 존재하지 않는 아이템**
- 시스템은 "아이템을 찾을 수 없습니다" 에러 메시지를 표시한다
- 시스템은 장바구니를 새로고침하여 최신 상태를 표시한다

### 6.6 사후 조건 (Post-conditions)
- 선택한 아이템이 장바구니에서 제거된다
- 장바구니 총 금액이 업데이트된다
- 장바구니가 비었을 수 있다

### 6.7 비즈니스 규칙 (Business Rules)

| ID | 규칙 | 설명 |
|----|------|------|
| BR-CART-10 | 아이템 삭제 | 개별 아이템만 삭제, 장바구니는 유지 |
| BR-CART-11 | 빈 장바구니 유지 | 모든 아이템 삭제 후에도 장바구니 엔티티는 유지 |

### 6.8 예외 케이스 (Exception Cases)

| 예외 상황 | 시스템 동작 |
|-----------|-------------|
| 장바구니를 찾을 수 없음 | 404 Not Found: "장바구니를 찾을 수 없습니다." |
| 아이템을 찾을 수 없음 | 404 Not Found: "아이템을 찾을 수 없습니다." |

---

## 7. UC-CART-05: 장바구니 전체 삭제

### 7.1 기본 정보

| 항목 | 내용 |
|------|------|
| **Use Case ID** | UC-CART-05 |
| **Use Case 명** | 장바구니 전체 삭제 |
| **Actor** | Customer, System |
| **Goal** | 고객이 장바구니의 모든 아이템을 한 번에 제거하거나 주문 완료 후 시스템이 자동으로 비운다 |
| **관련 User Story** | US-CART-05 |
| **관련 요구사항** | FR-CART-05 |
| **API Endpoint** | DELETE /carts |
| **우선순위** | SHOULD |

### 7.2 유스케이스 설명
장바구니의 모든 아이템을 한 번에 삭제합니다. 주문 완료 후에도 사용됩니다.

### 7.3 사전 조건 (Pre-conditions)
- 고객이 인증된 상태여야 함

### 7.4 주요 흐름 (Main Flow)

1. **전체 삭제 요청**
   - **고객이 수동 삭제**: 고객이 장바구니 페이지에서 "전체 삭제" 버튼을 클릭한다
   - **시스템이 자동 삭제**: 주문 완료 후 시스템이 자동으로 실행한다

2. **확인 (고객 수동 삭제 시)**
   - 시스템은 "모든 아이템을 삭제하시겠습니까?" 확인 메시지를 표시한다
   - 고객이 "확인"을 클릭한다

3. **전체 삭제 실행**
   - 시스템은 장바구니의 모든 아이템을 삭제한다
   - 장바구니 엔티티 자체는 유지된다 (소프트 삭제)

4. **결과 표시**
   - 시스템은 "장바구니가 비워졌습니다" 메시지를 표시한다
   - 시스템은 빈 장바구니 화면을 표시한다
   - 장바구니 아이콘의 아이템 개수가 0으로 업데이트된다

### 7.5 대체 흐름 (Alternative Flows)

**AF-1: 삭제 취소 (고객 수동 삭제 시)**
- 고객이 확인 다이얼로그에서 "취소"를 클릭한다
- 시스템은 아무 변경 없이 장바구니 페이지를 유지한다

**AF-2: 이미 빈 장바구니**
- 장바구니에 아이템이 없는 상태에서 전체 삭제 요청이 들어온다
- 시스템은 성공 응답을 반환한다 (에러 아님)
- 시스템은 "장바구니가 이미 비어 있습니다" 메시지를 표시한다

### 7.6 사후 조건 (Post-conditions)
- 장바구니의 모든 아이템이 제거된다
- 장바구니가 비어 있는 상태가 된다
- 총 금액이 0원이 된다

### 7.7 비즈니스 규칙 (Business Rules)

| ID | 규칙 | 설명 |
|----|------|------|
| BR-CART-12 | 전체 삭제 | 모든 아이템 제거, 장바구니는 유지 |
| BR-CART-13 | 주문 완료 후 자동 삭제 | 주문이 완료되면 시스템이 자동으로 장바구니 비움 |
| BR-CART-14 | 항상 성공 | 빈 장바구니에 대한 삭제 요청도 성공으로 처리 |

### 7.8 예외 케이스 (Exception Cases)

| 예외 상황 | 시스템 동작 |
|-----------|-------------|
| 없음 (항상 성공) | 204 No Content |

### 7.9 사용 시나리오

**시나리오 1: 고객이 직접 전체 삭제**
- 고객이 장바구니를 확인하다가 마음을 바꿔 모든 아이템을 삭제하고 싶을 때
- 고객이 처음부터 다시 쇼핑하고 싶을 때

**시나리오 2: 주문 완료 후 자동 삭제**
- 고객이 주문을 완료하면 시스템이 자동으로 장바구니를 비운다
- 다음 쇼핑을 위해 깨끗한 장바구니를 제공한다

---

## 8. 도메인 용어 정리

| 용어 | 설명 |
|------|------|
| **장바구니 (Cart)** | 고객이 주문 전 상품을 임시로 보관하는 공간 |
| **장바구니 아이템 (Cart Item)** | 장바구니에 담긴 개별 상품 (상품 + 옵션 + 수량) |
| **총 금액 (Total Amount)** | 장바구니에 담긴 모든 아이템의 가격 합계 |
| **소계 (Subtotal)** | 개별 아이템의 가격 × 수량 |
| **재고 검증** | 요청한 수량이 현재 재고 범위 내인지 확인 |
| **중복 아이템** | 동일한 상품 + 옵션 조합 |

---

## 9. 관련 문서

- [아키텍처](../architecture.md) - 시스템 아키텍처
- [요구사항 분석](../requirements.md) - 비즈니스 요구사항
- [사용자 스토리](../user-stories.md) - 사용자 관점의 시나리오
- [API 명세서](../api-specification.md) - REST API 계약
- [데이터 모델](../data-model.md) - 데이터베이스 스키마
- [Cart 시퀀스 다이어그램](./sequence-diagrams.md) - 기술 구현 명세
- [Product 유스케이스](../product/use-cases.md) - 이전 도메인
- [Order 유스케이스](../order/use-cases.md) - 다음 도메인

---

## 10. 버전 히스토리

| 버전 | 날짜 | 작성자 | 변경 내역 |
|------|------|--------|-----------|
| 1.0.0 | 2025-11-03 | Development Team | 초기 문서 작성 |
| 2.0.0 | 2025-11-03 | Development Team | 비즈니스 관점과 기술 관점 분리 (Issue #006) |

---

**문서 끝**
